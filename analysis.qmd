---
title: Analysis
description: Here we provide a detailed analysis using more sophisticated statistics techniques.
toc: true
draft: false
---

![](https://habitatbroward.org/wp-content/uploads/2020/01/10-Benefits-Showing-Why-Education-Is-Important-to-Our-Society.jpg)

### Section 1: Analysis of Education Statistics

Driven by the increasing interest in global education disparities, our team has decided to explore the educational landscape across various countries around the world. Education is a cornerstone of societal development, and by examining comprehensive datasets (please see the data tab to read more about our datasets), we aim to uncover the factors that contribute to education outcomes and identify disparities that may hinder equitable access to quality education. Our project seeks to provide insights that not can potentially inform policymakers, educators, and stakeholders about the key elements influencing educational success.

Our project begins with section 1, where we will identify educational trends by the continent and attempt to answer ***why*** these country's are the way they are.

In section 2, we will model our data with a linear regression model and uncover insights that are harder to identify on the surface

```{r}
#| label: libraries
#| echo: false
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(tidymodels))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(scales)) # for the label_comma() function
```

```{r}
#| label: data import
#| echo: false
#| 
data <- read_csv('dataset/educ.csv')
continent <- read_csv('dataset/continents2.csv')
pisa <- read_csv('dataset/pisa-scores-by-country-2024.csv')
literacy <- read_csv('dataset/literacy.csv')
```

```{r}
#| label: data cleaning
#| echo: false

# clean literacy
literacy_clean <- literacy |>
  filter(Age == '15+', Gender == 'total') |>
  group_by(Country) |>
  summarize(mean_literacy_rate = mean(`Literacy rate`, na.rm = TRUE))

literacy_clean <- literacy_clean |>
  rename(
    country = Country
  )

```

```{r}
#| label: data cleaning2
#| echo: false

# rename columns to make it easier to merge
continent <- continent |>
  rename(
    country = name,
    sub_region = `sub-region`
  )
```

```{r}
#| label: data merging
#| echo: false

# merge the data
merged_data <- merge(data, continent, by = "country")
merged_data2 <- merge(merged_data, pisa, by = "country")
merged_data3 <- merge(continent, literacy_clean, by = "country")
```

### Section 1.1: PISA Scores and Literacy Rates

The first step to understanding economic disparties is to get a general understanding of what parts of the world generally tend to have better education than others. There are multiple ways of measuring this, but reliable way to measure this is with PISA scores and literacy rates. Both of these metrics serve as standardized bench marks for the whole world!

```{r}
#| label: PISA
#| echo: false

continent_pisa <- merged_data2 |>
  group_by(region) |>
  summarise(overallpisa2022 = mean(OverallPisaScore2022, na.rm = TRUE)) |>
  ggplot(aes(x = region, y = overallpisa2022, fill = region)) + geom_col()

continent_pisa
```

```{r}
#| label: literacy
#| echo: false
continent_literacy <- merged_data3 |>
  filter(region != "Americas") |>
  group_by(region) |>
  summarise(literacy = mean(mean_literacy_rate, na.rm = TRUE)) |>
  ggplot(aes(x = region, y = literacy, fill = region)) + geom_col()

continent_literacy
```

```{r}
#| label: pisa facet
#| echo: false
#| 
americas_pisa_long <- merged_data2 %>%
  group_by(country) %>%
  summarise(
    pisa_overall_mean = mean(OverallPisaScore2022, na.rm = TRUE),
    pisa_math_mean = mean(PISAScoresMathScore2022, na.rm = TRUE), # Assuming you meant Math Score here
    pisa_science_mean = mean(PISAScoresScienceScore2022, na.rm = TRUE),
    pisa_reading_mean = mean(PISAScoresReadingScore2022, na.rm = TRUE),
    region = region
  ) %>%
  pivot_longer(
    cols = starts_with("pisa_"),
    names_to = "score_type",
    values_to = "score"
  ) %>%
  mutate(score_type = factor(score_type, levels = c("pisa_overall_mean", "pisa_math_mean", "pisa_science_mean", "pisa_reading_mean")))

# Creating the plot
americas_pisa_plot <- americas_pisa_long %>%
  ggplot(aes(x = country, y = score, fill = score_type)) + 
  geom_col(position = "dodge") + 
  scale_y_continuous(labels = label_comma()) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(y = "PISA Score", x = "Country", fill = "Score Type") +
  scale_fill_brewer(palette = "Pastel1") +
  facet_wrap(~ region, scales = "free_x") 

americas_pisa_plot
```

It is clear that in terms of PISA scores, Oceania and Europe perform the best, while Africa performed the worst, and in terms of literacy rate, all of the continents performed relatively equally while Africa performed the worst again. Now that you have a general understanding of where education is better and where education is worse, we can now get into more specific statistics.

### Section 1.2: Percentage of People who did not Complete Primary School

The next step of analyzing education around the world was to simply look at the percentage of (i) children and young people aged 3-5 years above primary school graduation age and (ii) young people aged 15-24, who have completed primary school.

```{r}
#| label: priary school completion 3-5
#| echo: false

continent_pisa2 <- merged_data |>
  group_by(region, year) |>
  summarise(complete_prim = mean(comp_prim_v2_m, na.rm = TRUE)) |>
  ggplot(aes(x = year, y = complete_prim, color = region)) +
    geom_line() +
  labs(
    title = "Primary School Completion Rate for People aged 3-5 years above primary school"
  )

continent_pisa2
```

```{r}
#| label: primary school completion 20-24
#| echo: false

continent_pisa2 <- merged_data |>
  group_by(region, year) |>
  summarise(complete_prim = mean(comp_prim_1524_m, na.rm = TRUE)) |>
  ggplot(aes(x = year, y = complete_prim, color = region)) +
    geom_line() + 
  labs(
    title = "Primary School Completion Rate for ages 15-24"
  )

continent_pisa2
```

As you can see, Europe (while it has a lot of missing data), consistently ranks significantly higher than all of the other continents, while North America, South America, and Asia rank below Europe but higher than Africa.

```{r}
#| label: north africa primary completion
#| echo: false

northern_africa_mean_completion <- merged_data |>
  filter(sub_region %in% c('Northern Africa')) |>
  group_by(iso_code) |>
  summarise(mean_primary_completion_rate = mean(comp_prim_v2_m, na.rm = TRUE),
            percent_people_not_in_primary_school = mean(eduout_upsec_m, na.rm = TRUE),
            mean_educ_years_20_24 = mean(eduyears_2024_m, na.rm = TRUE),
            attend_higher_education = mean(attend_higher_1822_m, na.rm = TRUE),
            number_complete_prim_1524 = mean(comp_prim_1524_no, na.rm = TRUE),
            count = n()
            ) |>
  ggplot(aes(x = iso_code, y = mean_primary_completion_rate, fill = iso_code)) +
    geom_col() +ylim(c(0,1)) + theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
northern_africa_mean_completion
```

```{r}
#| label: sub-saharan africa primary school completion
#| echo: false

subsaharan_africa_mean_completion <- merged_data |>
  filter(sub_region %in% c('Sub-Saharan Africa')) |>
  group_by(iso_code) |>
  summarise(mean_primary_completion_rate = mean(comp_prim_v2_m, na.rm = TRUE),
            percent_people_not_in_primary_school = mean(eduout_upsec_m, na.rm = TRUE),
            mean_educ_years_20_24 = mean(eduyears_2024_m, na.rm = TRUE),
            attend_higher_education = mean(attend_higher_1822_m, na.rm = TRUE),
            number_complete_prim_1524 = mean(comp_prim_1524_no, na.rm = TRUE),
            count = n()
            ) |>
  ggplot(aes(x = iso_code, y = mean_primary_completion_rate)) +
    geom_col() +ylim(c(0,1)) + theme(axis.text.x = element_text(angle = 60, hjust = 1))
subsaharan_africa_mean_completion
```

As you can see, when looking at the % of people who finish primary school, the percentages are significantly lower for the sub-saharan African countries compared to the Northern African countries. It seems like Sub-Saharan Africa may be the reason Africa shows up so low in many of the plots in the first section. In fact, Northern Africa seems to be on par in terms of primary school completion rate when compared to the rest of the continents in the world, but Sub-Sahara Africa does not seem to be on par. This difference in regions suggests that much attention should actually be directed towards Sub-Saharan Africa rather than Africa as a whole.

The good news is that all countries seem to have a slow yet steady increase in their primary school completion rate which is great to see.

The next step is to analyze the mean years of education of each region

### Section 1.3: Mean Years of Education

### Section 1.4: Rural vs Urban

```{r}
#| label: rural vs urban
#| echo: false

grouped7 <- merged_data2 |>
  group_by(region, Location) |>
  summarise(
    mean_educ_years_20_24 = mean(eduyears_2024_m, na.rm = TRUE),
    count = n()
  ) |>
  ggplot(
    aes(x = Location, y = mean_educ_years_20_24, fill = Location) 
  )+geom_col() +
  facet_wrap(~ region, scales = "free_x") 

grouped7
```

This suggests that education should be focused more on Rural areas rather than non-rural areas

### Section 1.5: Male vs. Female

```{r}
#| label: sub_region rural vs urban
#| echo: false

grouped7 <- merged_data2 |>
  group_by(sub_region, Sex) |>
  summarise(
    mean_educ_years_20_24 = mean(eduyears_2024_m, na.rm = TRUE),
    count = n()
  ) |>
  ggplot(
    aes(x = Sex, y = mean_educ_years_20_24, fill = Sex) 
  )+geom_col() +
  facet_wrap(~ sub_region, scales = "free_x") 

grouped7
```

Relatively even except for Africa where the males get more education. Surprisnly, females get more education except for in Africa.

### Section 2: Modeling
```{r}
#| label: model cleaning
#| echo: false

grouped2 <- data |>
  group_by(iso_code) |>
  summarise(mean_primary_completion_rate = mean(comp_prim_v2_m, na.rm = TRUE),
            mean_educ_years_20_24 = mean(eduyears_2024_m, na.rm = TRUE),
            attend_higher_education = mean(attend_higher_1822_m, na.rm = TRUE),
            count = n()) |>
  ungroup()
grouped2
```

```{r}
#| label: linear model
#| echo: false

lm_model <- 
  linear_reg() |> 
  set_engine("lm")

lm_form_fit <- 
  lm_model %>% 
  fit(mean_primary_completion_rate ~ mean_educ_years_20_24, data = grouped2)

lm_form_fit
```

```{r}
#| label: model summary
#| echo: false

summary(lm_form_fit)
```

```{r}
#| label: model summary 2
#| echo: false

broom::glance(lm_form_fit)
broom::augment(lm_form_fit, new_data = grouped2)
```

```{r}
#| label: residual plot
#| echo: false

ggplot(grouped2, aes(x = mean_educ_years_20_24, y=mean_primary_completion_rate)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', color = 'red')
```






Thesis: African areas have poor educational resources compared with other regions in the World. (find what makes the poor education: primary school completion rate, urban/rural, )

Hypothesis 1: Factors that will affect the lower secondary school completion rate: primary school completion rate_v2(young people who are 3-5 ages above the normal primary graduation age\[prolly neagtively affect the lower secondary school completion rate\]) + Big_REGION +WEALTH + gender

Pre-primary education attendance significantly affects primary school completion rates, with variations noticeable between rural and urban settings within African countries. Model: Multiple linear regression with primary completion rate as the dependent variable, and pre-primary education attendance, location (if data on rural/urban is available), and possibly region as independent variables. Take a look at how Africa performs(on each variable both x and y) before applying model

```{r}
continent <- read_csv('dataset/continents2.csv')
data <- read_csv('dataset/educ.csv')
pisa <- read_csv('dataset/pisa-scores-by-country-2024.csv')
literacy <- read_csv('dataset/literacy.csv')
continent <- continent |>
  rename(
    country = name,
    sub_region = `sub-region`
  )

merged_data <- merge(data, continent, by = "country")
```

```{r}
#group by wealth, Big region
merged_data
Location_data <- merged_data %>%
  filter(category == 'Location & Sex & Wealth')
Location_data
summary(as.factor(Location_data$Location))
summary(as.factor(Location_data$Wealth))
summary(as.factor(Location_data$Sex))

model1 <- lm(comp_lowsec_v2_m ~ as.factor(region) + as.factor(Location) + as.factor(Sex)  + as.factor(Wealth) + comp_prim_v2_m, data = Location_data)
summary(model1)
```

```{r}
library(car)
broom::glance(model1)
broom::augment(model1, new_data = grouped2)
vif(model1)
```

no multicollinearity

```{r}
library(car)
library(caret)
library(ggplot2)
library(dplyr)
library(readxl)
library(MLmetrics)
library(GGally)
```

```{r}
boxplot(Location_data$comp_lowsec_v2_m)
#ggplot(grouped2, aes(x = mean_educ_years_20_24, y=mean_primary_completion_rate)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', color = 'red')
```

Hypothesis 2: Overall PISA score \~ primary_completion_rate(young people aged 15-24 completed primary schoool) + transition rate to lower secondary + region + location + wealth

PISA score is for students age group of 15\~16. Consider transition rate to lower secondary school.

```{r}
merged_pisa <- merge(merged_data, pisa, by = "country")
merged_literacy <- merge(continent, literacy_clean, by = "country")
merged_pisa

pisa_data <- merged_pisa %>%
  filter(category == 'Location') |> group_by(region, Location) |> summarise(average_overall_pisa = mean(OverallPisaScore2022, na.rm = TRUE), mean_primary_completion_rate_15_24 = mean(comp_prim_1524_m, na.rm = TRUE), mean_transition_to_lowsec_rate = mean(trans_prim_m, na.rm = TRUE), .groups = 'drop')
pisa_data

model2 <- lm(average_overall_pisa ~ as.factor(region) + as.factor(Location) + mean_primary_completion_rate_15_24 + mean_transition_to_lowsec_rate, data = pisa_data)
summary(model2)
vif(model2)
```

Model 3

